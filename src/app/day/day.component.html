<mat-card>
  <mat-card-title>{{formattedDate}}</mat-card-title>
</mat-card>

<mat-card *ngFor="let task of tasks; index as i">
  <mat-card-content>
    <div *ngIf="editingId !== task.id">
      <h2>{{task.title}}</h2>
      <p>Срок исполнения: {{task.dueDate }}</p>
      <mat-card-content>
        {{task.content}}
      </mat-card-content>
      <button mat-button color="primary" (click)="toggleTaskStatus(task.id)">{{task.completed ? 'Вернуть в работу' : 'Завершить'}}</button>
      <button mat-button color="warn" (click)="removeTask(task.id)">Удалить</button>
      <button mat-button color="accent" (click)="openEditDialog(task)">Редактировать</button>
    </div>
    <div *ngIf="editingId === task.id">
      <mat-form-field class="example-full-width">
        <input matInput placeholder="Заголовок" [(ngModel)]="task.title">
      </mat-form-field>
      <mat-form-field class="example-full-width">
        <input matInput placeholder="Срок исполнения" [(ngModel)]="task.dueDate" type="date">
      </mat-form-field>
      <mat-form-field class="example-full-width">
        <input matInput placeholder="Задача" [(ngModel)]="task.content">
      </mat-form-field>
      <button mat-raised-button color="primary" (click)="saveTask(task.id, task.title, task.dueDate.format('YYYY-MM-DD'), task.content)">Сохранить</button>
    </div>
  </mat-card-content>
</mat-card>

<form [formGroup]="taskForm" (ngSubmit)="addTask()">
  <mat-form-field class="example-full-width">
    <input matInput placeholder="Заголовок" formControlName="title">
    <mat-error *ngIf="taskForm.controls['title'].invalid && taskForm.controls['title'].touched">Это поле обязательно</mat-error>
  </mat-form-field>
  <mat-form-field>
    <input matInput [matDatepicker]="picker" formControlName="dueDate" placeholder="Срок исполнения">
    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
    <mat-datepicker #picker></mat-datepicker>
    <mat-error *ngIf="taskForm.controls['dueDate'].invalid && taskForm.controls['dueDate'].touched">Это поле обязательно</mat-error>

  </mat-form-field>
  <mat-form-field class="example-full-width">
    <input matInput placeholder="Описание задачи" formControlName="content">
    <mat-error *ngIf="taskForm.controls['content'].invalid && taskForm.controls['content'].touched">Это поле обязательно</mat-error>
  </mat-form-field>
  <button mat-raised-button color="primary" type="submit">Добавить задачу</button>
</form>
